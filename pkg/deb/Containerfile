FROM debian:latest

ARG PATH_CODE
WORKDIR ${PATH_CODE}
ENV PATHS_ENV=${PATH_CODE}/debian/src/build/paths.env

# Install generic build dependencies
RUN \
    apt update -y && \
    apt install dh-make -y && \
    apt install debmake -y && \
    apt install build-essential -y

# Build and install
RUN \
    # Install package specific build dependencies
    apt-get build-dep -y . && \
    # Build the package
    debuild --preserve-env -b --no-sign --lintian-opts --allow-root && \
    apt install -y /growbies*.deb
#     systemctl enable growbies

# RUN \
#     . ${PATHS_ENV} && \
#     cd ${PATH_DEBIAN_DB} && \
#     ./$(basename ${PATH_DEBIAN_DB_INIT_SH})
#     echo "emey emey: ${PATH_DEBIAN_DB}" && \
#     echo "emey script: $(basename ${PATH_DEBIAN_DB_INIT_SH})" \

CMD [ "/usr/lib/systemd/systemd" ]
